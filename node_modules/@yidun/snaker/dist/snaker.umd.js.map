{"version":3,"file":"snaker.umd.js","sources":["../src/utils.ts","../src/userStore.ts","../src/cache.ts","../src/index.ts"],"sourcesContent":["export function getCookie(name: string): string {\n  const cookiePattern = new RegExp('(^|;)[ ]*' + name + '=([^;]*)')\n  const cookieMatch = cookiePattern.exec(document.cookie)\n  return cookieMatch ? decodeURIComponent(cookieMatch[2]) : ''\n}\n\nexport function setCookie(name: string, value: any, maxAge?: number): void {\n  let expiredTime: Date\n  let cookie: string = name + '=' + encodeURIComponent(value) + ';'\n\n  if (maxAge) {\n    expiredTime = new Date()\n    expiredTime.setTime(expiredTime.getTime() + maxAge)\n    cookie += `expires=${expiredTime.toUTCString()}`\n  }\n\n  document.cookie = cookie\n}\n\nexport function uuid(): string {\n  const chars = 'abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'\n\n  let id = ''\n  let i = 0\n  for (let l = chars.length; i < 16; i++) {\n    id += chars.charAt(Math.floor(Math.random() * l))\n  }\n\n  return id\n}\n","export interface IEUserData extends HTMLInputElement {\n  save(name: string): void\n  load(name: string): void\n  expires: string\n  addBehavior(arg0: string): void\n}\nexport interface UserStore {\n  userData: IEUserData | null\n  name: string\n  init: () => boolean\n  setItem(key: string, value: string): void\n  getItem(key: string): string\n  removeItem(key: string): void\n}\n\nconst userStore: UserStore = {\n  userData: null,\n  name: `${location.hostname}_snaker`,\n  init () {\n    if (!userStore.userData) {\n      try {\n        userStore.userData = document.createElement('INPUT') as IEUserData\n        userStore.userData.type = 'hidden'\n        userStore.userData.style.display = 'none'\n        userStore.userData.addBehavior('#default#userData')\n        userStore.userData && document.body.appendChild(userStore.userData)\n\n        const expires = new Date()\n        expires.setDate(expires.getDate() + 365)\n        userStore.userData.expires = expires.toUTCString()\n      } catch (error) {\n        console.log('userData is disabled!')\n        return false\n      }\n    }\n    return true\n  },\n  setItem (key, value) {\n    if (userStore.init() && userStore.userData) {\n      userStore.userData.load(userStore.name)\n      userStore.userData.setAttribute(key, value)\n      userStore.userData.save(userStore.name)\n    }\n  },\n  getItem (key) {\n    if (userStore.init() && userStore.userData) {\n      userStore.userData.load(userStore.name)\n      return userStore.userData.getAttribute(key) || ''\n    }\n    return ''\n  },\n  removeItem (key) {\n    if (userStore.init() && userStore.userData) {\n      userStore.userData.load(userStore.name)\n      userStore.userData.removeAttribute(key)\n      userStore.userData.save(userStore.name)\n    }\n  }\n}\n\nexport default userStore\n","import userStore, { UserStore } from './userStore'\n\nlet localStore: Storage | UserStore\ntry {\n  localStore = localStorage || userStore\n} catch (err) {\n  localStore = userStore\n}\nexport default class History {\n  name: string\n\n  constructor(name: string) {\n    this.name = name\n  }\n\n  push(log: string) {\n    if (!log) return\n    try {\n      const previous = localStore.getItem(this.name)\n      localStore.setItem(this.name, previous ? previous + ',' + log : log)\n    } catch (error) {\n      console.log('localstorage or userData is disabled!')\n    }\n  }\n\n  length(): number {\n    try {\n      const logs = localStore.getItem(this.name) || ''\n      return logs ? logs.split(',').length : 0\n    } catch (error) {\n      console.log('localstorage or userData is disabled!')\n      return 0\n    }\n  }\n\n  pop(len: number = 1): string[] {\n    let poped: string[]\n    try {\n      const value = localStore.getItem(this.name)\n      const logs = value ? value.split(',') : []\n      poped = logs.splice(0, len)\n      localStore.setItem(this.name, logs.join(','))\n    } catch (error) {\n      poped = []\n      console.log('localstorage or userData is disabled!')\n    }\n    return poped\n  }\n\n  clear() {\n    try {\n      localStore.removeItem(this.name)\n    } catch (error) {\n      console.log('localstorage or userData is disabled!')\n    }\n  }\n}\n","import { getCookie, setCookie, uuid } from './utils'\nimport Cache from './cache'\n\nexport interface Options {\n  pid: string\n  bid?: string\n  url?: string\n  random?: number\n  limit?: number\n  disabled?: boolean,\n  version?: string\n}\n\nexport interface Event {\n  type: string\n  name: string\n  value: string\n}\n\nexport interface UserInfo {\n  uid: string\n  [index: string]: string\n}\n\nexport default class Snaker {\n  pid: string\n  bid?: string\n  url: string\n  user?: UserInfo\n  random: number\n  limit: number\n  uuid: string\n  prefix: string\n  cache: Cache\n  disabled?: boolean\n  version?: string\n\n  constructor(options: Options) {\n    if (!options.pid) throw new Error('product id is required!')\n\n    const { pid, bid, url, random, limit, disabled, version } = options\n    this.pid = pid\n    this.bid = bid\n    this.random = random || 1\n    this.limit = limit || 5\n    this.disabled = disabled\n    this.version = version || ''\n    this.url = url || 'https://da.dun.163.com/sn.gif'\n    this.prefix = '__snaker__id'\n\n    this.cache = new Cache(this.prefix)\n\n    const localCacheInfo = getCookie(this.prefix)\n    if (localCacheInfo) {\n      this.uuid = localCacheInfo\n    } else {\n      this.uuid = uuid()\n      setCookie(this.prefix, this.uuid, 1000 * 60 * 60 * 24 * 365)\n    }\n  }\n\n  setUser(user: string | UserInfo) {\n    if (typeof user === 'string') {\n      this.user = {\n        uid: user\n      }\n    } else {\n      this.user = { uid: user.uid }\n      for (let key in user) {\n        if (!user.hasOwnProperty(key)) {\n          continue\n        } else {\n          if (key !== 'uid') this.user['$user_' + key] = user[key]\n        }\n      }\n    }\n  }\n\n  serialize(data: Event, extra: object): string {\n    const { pid, bid, uuid, user, version } = this\n    const { type, name, value } = data\n    const slice = (str: string, len: number): string => str.substring(0, len)\n\n    const resolution: string = screen.width + 'x' + screen.height\n    const pageUrl = slice(location.href, 200)\n    const now = new Date().getTime() + ''\n\n    const params: { [index: string]: string | undefined } = {\n      pid,\n      bid,\n      uuid,\n      type,\n      name,\n      version,\n      value,\n      res: resolution,\n      pu: pageUrl,\n      nts: now,\n      ...extra,\n      ...user\n    }\n\n    const query: string[] = []\n    for (let key in params) {\n      if (!params.hasOwnProperty(key)) {\n        continue\n      } else {\n        if (params[key] !== undefined) {\n          query.push(encodeURIComponent(key + '=') + encodeURIComponent(encodeURIComponent(params[key] as string)))\n        } else {\n          continue\n        }\n      }\n    }\n    return query.join('%26')\n  }\n\n  sendRequest(server: string, data: string): void {\n    if(this.disabled) return\n\n    const image = new Image(1, 1)\n    image.src = server + '?d=' + data\n  }\n\n  report(type: string, name: string, value: string, offline?: boolean, extra?: object): void {\n    if(this.disabled) return\n    if (this.random < Math.random()) return\n\n    const log = this.serialize({ type, name, value }, extra ? extra : {})\n    if (offline) {\n      this.cache.push(log)\n      if (this.cache.length() >= this.limit) {\n        this.flush()\n      }\n    } else {\n      this.sendRequest(this.url, log)\n    }\n  }\n\n  track(type: string, name: string, value: string, extra?: object) {\n    this.report(type, name, value, false, extra)\n  }\n\n  trackAsync(type: string, name: string, value: string, extra?: object) {\n    this.report(type, name, value, true, extra)\n  }\n\n  flush() {\n    let payload: string = ''\n    const logs = this.cache.pop(this.limit)\n\n    while (logs.length) {\n      let poped = logs.pop() || ''\n      if (!poped) continue\n      payload = payload ? payload + ',' + poped : poped\n      if (payload.length > 1800) {\n        this.sendRequest(this.url, payload)\n        payload = ''\n      }\n    }\n\n    if(payload) {\n      this.sendRequest(this.url, payload);\n    }\n  }\n}\n"],"names":["Cache","uuid"],"mappings":"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"}
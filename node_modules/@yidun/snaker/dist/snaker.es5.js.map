{"version":3,"file":"snaker.es5.js","sources":["../src/utils.ts","../src/userStore.ts","../src/cache.ts","../src/index.ts"],"sourcesContent":["export function getCookie(name: string): string {\n  const cookiePattern = new RegExp('(^|;)[ ]*' + name + '=([^;]*)')\n  const cookieMatch = cookiePattern.exec(document.cookie)\n  return cookieMatch ? decodeURIComponent(cookieMatch[2]) : ''\n}\n\nexport function setCookie(name: string, value: any, maxAge?: number): void {\n  let expiredTime: Date\n  let cookie: string = name + '=' + encodeURIComponent(value) + ';'\n\n  if (maxAge) {\n    expiredTime = new Date()\n    expiredTime.setTime(expiredTime.getTime() + maxAge)\n    cookie += `expires=${expiredTime.toUTCString()}`\n  }\n\n  document.cookie = cookie\n}\n\nexport function uuid(): string {\n  const chars = 'abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'\n\n  let id = ''\n  let i = 0\n  for (let l = chars.length; i < 16; i++) {\n    id += chars.charAt(Math.floor(Math.random() * l))\n  }\n\n  return id\n}\n","export interface IEUserData extends HTMLInputElement {\n  save(name: string): void\n  load(name: string): void\n  expires: string\n  addBehavior(arg0: string): void\n}\nexport interface UserStore {\n  userData: IEUserData | null\n  name: string\n  init: () => boolean\n  setItem(key: string, value: string): void\n  getItem(key: string): string\n  removeItem(key: string): void\n}\n\nconst userStore: UserStore = {\n  userData: null,\n  name: `${location.hostname}_snaker`,\n  init () {\n    if (!userStore.userData) {\n      try {\n        userStore.userData = document.createElement('INPUT') as IEUserData\n        userStore.userData.type = 'hidden'\n        userStore.userData.style.display = 'none'\n        userStore.userData.addBehavior('#default#userData')\n        userStore.userData && document.body.appendChild(userStore.userData)\n\n        const expires = new Date()\n        expires.setDate(expires.getDate() + 365)\n        userStore.userData.expires = expires.toUTCString()\n      } catch (error) {\n        console.log('userData is disabled!')\n        return false\n      }\n    }\n    return true\n  },\n  setItem (key, value) {\n    if (userStore.init() && userStore.userData) {\n      userStore.userData.load(userStore.name)\n      userStore.userData.setAttribute(key, value)\n      userStore.userData.save(userStore.name)\n    }\n  },\n  getItem (key) {\n    if (userStore.init() && userStore.userData) {\n      userStore.userData.load(userStore.name)\n      return userStore.userData.getAttribute(key) || ''\n    }\n    return ''\n  },\n  removeItem (key) {\n    if (userStore.init() && userStore.userData) {\n      userStore.userData.load(userStore.name)\n      userStore.userData.removeAttribute(key)\n      userStore.userData.save(userStore.name)\n    }\n  }\n}\n\nexport default userStore\n","import userStore, { UserStore } from './userStore'\n\nlet localStore: Storage | UserStore\ntry {\n  localStore = localStorage || userStore\n} catch (err) {\n  localStore = userStore\n}\nexport default class History {\n  name: string\n\n  constructor(name: string) {\n    this.name = name\n  }\n\n  push(log: string) {\n    if (!log) return\n    try {\n      const previous = localStore.getItem(this.name)\n      localStore.setItem(this.name, previous ? previous + ',' + log : log)\n    } catch (error) {\n      console.log('localstorage or userData is disabled!')\n    }\n  }\n\n  length(): number {\n    try {\n      const logs = localStore.getItem(this.name) || ''\n      return logs ? logs.split(',').length : 0\n    } catch (error) {\n      console.log('localstorage or userData is disabled!')\n      return 0\n    }\n  }\n\n  pop(len: number = 1): string[] {\n    let poped: string[]\n    try {\n      const value = localStore.getItem(this.name)\n      const logs = value ? value.split(',') : []\n      poped = logs.splice(0, len)\n      localStore.setItem(this.name, logs.join(','))\n    } catch (error) {\n      poped = []\n      console.log('localstorage or userData is disabled!')\n    }\n    return poped\n  }\n\n  clear() {\n    try {\n      localStore.removeItem(this.name)\n    } catch (error) {\n      console.log('localstorage or userData is disabled!')\n    }\n  }\n}\n","import { getCookie, setCookie, uuid } from './utils'\nimport Cache from './cache'\n\nexport interface Options {\n  pid: string\n  bid?: string\n  url?: string\n  random?: number\n  limit?: number\n  disabled?: boolean,\n  version?: string\n}\n\nexport interface Event {\n  type: string\n  name: string\n  value: string\n}\n\nexport interface UserInfo {\n  uid: string\n  [index: string]: string\n}\n\nexport default class Snaker {\n  pid: string\n  bid?: string\n  url: string\n  user?: UserInfo\n  random: number\n  limit: number\n  uuid: string\n  prefix: string\n  cache: Cache\n  disabled?: boolean\n  version?: string\n\n  constructor(options: Options) {\n    if (!options.pid) throw new Error('product id is required!')\n\n    const { pid, bid, url, random, limit, disabled, version } = options\n    this.pid = pid\n    this.bid = bid\n    this.random = random || 1\n    this.limit = limit || 5\n    this.disabled = disabled\n    this.version = version || ''\n    this.url = url || 'https://da.dun.163.com/sn.gif'\n    this.prefix = '__snaker__id'\n\n    this.cache = new Cache(this.prefix)\n\n    const localCacheInfo = getCookie(this.prefix)\n    if (localCacheInfo) {\n      this.uuid = localCacheInfo\n    } else {\n      this.uuid = uuid()\n      setCookie(this.prefix, this.uuid, 1000 * 60 * 60 * 24 * 365)\n    }\n  }\n\n  setUser(user: string | UserInfo) {\n    if (typeof user === 'string') {\n      this.user = {\n        uid: user\n      }\n    } else {\n      this.user = { uid: user.uid }\n      for (let key in user) {\n        if (!user.hasOwnProperty(key)) {\n          continue\n        } else {\n          if (key !== 'uid') this.user['$user_' + key] = user[key]\n        }\n      }\n    }\n  }\n\n  serialize(data: Event, extra: object): string {\n    const { pid, bid, uuid, user, version } = this\n    const { type, name, value } = data\n    const slice = (str: string, len: number): string => str.substring(0, len)\n\n    const resolution: string = screen.width + 'x' + screen.height\n    const pageUrl = slice(location.href, 200)\n    const now = new Date().getTime() + ''\n\n    const params: { [index: string]: string | undefined } = {\n      pid,\n      bid,\n      uuid,\n      type,\n      name,\n      version,\n      value,\n      res: resolution,\n      pu: pageUrl,\n      nts: now,\n      ...extra,\n      ...user\n    }\n\n    const query: string[] = []\n    for (let key in params) {\n      if (!params.hasOwnProperty(key)) {\n        continue\n      } else {\n        if (params[key] !== undefined) {\n          query.push(encodeURIComponent(key + '=') + encodeURIComponent(encodeURIComponent(params[key] as string)))\n        } else {\n          continue\n        }\n      }\n    }\n    return query.join('%26')\n  }\n\n  sendRequest(server: string, data: string): void {\n    if(this.disabled) return\n\n    const image = new Image(1, 1)\n    image.src = server + '?d=' + data\n  }\n\n  report(type: string, name: string, value: string, offline?: boolean, extra?: object): void {\n    if(this.disabled) return\n    if (this.random < Math.random()) return\n\n    const log = this.serialize({ type, name, value }, extra ? extra : {})\n    if (offline) {\n      this.cache.push(log)\n      if (this.cache.length() >= this.limit) {\n        this.flush()\n      }\n    } else {\n      this.sendRequest(this.url, log)\n    }\n  }\n\n  track(type: string, name: string, value: string, extra?: object) {\n    this.report(type, name, value, false, extra)\n  }\n\n  trackAsync(type: string, name: string, value: string, extra?: object) {\n    this.report(type, name, value, true, extra)\n  }\n\n  flush() {\n    let payload: string = ''\n    const logs = this.cache.pop(this.limit)\n\n    while (logs.length) {\n      let poped = logs.pop() || ''\n      if (!poped) continue\n      payload = payload ? payload + ',' + poped : poped\n      if (payload.length > 1800) {\n        this.sendRequest(this.url, payload)\n        payload = ''\n      }\n    }\n\n    if(payload) {\n      this.sendRequest(this.url, payload);\n    }\n  }\n}\n"],"names":["Cache","uuid"],"mappings":"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"}